<head>
  <title>sites-meteor</title>
</head>

<body>
    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container-fluid">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar">A</span>
                    <span class="icon-bar">B</span>
                    <span class="icon-bar">C</span>
                </a>
                <a class="brand" href="/">{{> title }}</a>
                <div class="nav-collapse collapse pull-right">
                    <p class="navbar-text pull-right">
                        {{ loginButtons }}
                    </p>
                </div>
            </div>
        </div>
    </div>
    <br/>
    <br/>
    <br/>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span12">
                {{> table }}
            </div>
        </div>
        <div class="row-fluid">
            <div class="span12">
                {{> show }}
            </div>
        </div>
    </div>
    {{> footer }}
    <div id="edit"></div>
</body>

<template name="title">
    {{ title }}
</template>

<template name="footer">
    <footer>
        <hr>
        <p>&copy; {{ copyright }} {{ currentPage }}</p>
    </footer>
</template>

<template name="table">
    <table id="replace" class="table table-striped table-hover table-bordered table-condensed">
        <thead>
            <tr>
                <th class="site">
                    <a href="{{ git_web }}" title="Repositories">Site</a>
                </th>
                {{#each environment }}
                    {{> env_head }}
                {{/each }}
            </tr>
        </thead>
        {{#each group }}
            {{> group }}
        {{/each }}
    </table>
</template>

<template name="env_head">
    <th class="{{ state }}" title="{{ action }} {{ name }}">{{ label }}</th>
</template>

<template name="group">
    <tbody>
        <tr>
            <th id="group_{{ name }}" class="group head {{ state }}" title="{{ action }} {{ name }}" colspan="{{ colspan }}">{{ label }}</th>
        </tr>
        {{#each group }}
            {{> group_data }}
        {{/each }}
    </tbody>
</template>

<template name="group_data">
    <tr class="group-{{ group }} {{ display }}">
        <td>
            <p class="pull-left">{{ label }}</p>
            {{#if loggedin }}
                {{> edit }}
            {{/if }}
            <div class="pull-right">[ {{> links }} ]</div>
        </td>
        {{#each environment }}
            {{> group_env }}
        {{/each }}
    </tr>
</template>

<template name="group_env">
    <td class="env {{ name }} {{ state }}">
        {{> links }}
    </td>
</template>

<template name="links">
{{#each links }}
    <a href="{{ url }}" title="{{ name }}">{{ label }}</a> {{ pipe }}
{{/each }}
</template>

<template name="show">
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>Show:</th>
                {{#each environments }}
                    {{> show_env }}
                {{/each }}
            </tr>
        </thead>
    </table>
</template>

<template name="show_env">
    <th class="display {{ name }} note {{ state }}" title="{{ action }} {{ name }}">
        {{ label }}
    </th>
</template>

<template name="edit">
    <div class="edit pull-left"><a href="#" title="Edit {{ name }}'s data">Edit</a></div>
</template>

<template name="roup_env">
</template>
